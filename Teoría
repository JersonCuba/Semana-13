
üìò Semana 13 ‚Äì Transact-SQL

üí° ¬øQu√© es Transact-SQL?

Transact-SQL (T-SQL) es la extensi√≥n de SQL utilizada por SQL Server.
Permite no solo consultar datos, sino tambi√©n programar l√≥gica dentro de la base de datos mediante funciones, procedimientos, variables, condicionales y cursores.


---

üîπ Funciones (Functions)

Una funci√≥n es un bloque de c√≥digo reutilizable que siempre devuelve un valor.
Se usa para realizar c√°lculos o procesar datos.

CREATE FUNCTION dbo.CalcularAreaCirculo (@Radio FLOAT)
RETURNS FLOAT
AS
BEGIN
    RETURN PI() * @Radio * @Radio;
END;

Uso:

SELECT dbo.CalcularAreaCirculo(5);

‚úÖ Las funciones no modifican datos, solo calculan y devuelven informaci√≥n.


---

üîπ Procedimientos Almacenados (Stored Procedures)

Un procedimiento almacenado puede ejecutar varias sentencias SQL, no requiere devolver un valor y puede modificar datos.

CREATE PROCEDURE dbo.InsertarEmpleado
    @Nombre NVARCHAR(50),
    @Edad INT,
    @Departamento NVARCHAR(50)
AS
BEGIN
    INSERT INTO Empleados (Nombre, Edad, Departamento)
    VALUES (@Nombre, @Edad, @Departamento);
END;

Uso:

EXEC dbo.InsertarEmpleado 'Juan P√©rez', 30, 'Ventas';

‚úÖ Los procedimientos se usan para automatizar tareas.


---

üîπ Variables en T-SQL

Permiten almacenar valores temporalmente dentro de un script.

DECLARE @Nombre NVARCHAR(50);
SET @Nombre = 'Ana G√≥mez';
SELECT @Nombre AS Nombre;

‚úÖ Son √∫tiles cuando una consulta necesita valores din√°micos.


---

üîπ Condicional IF

Permite ejecutar c√≥digo seg√∫n una condici√≥n l√≥gica.

DECLARE @Edad INT = 20;

IF @Edad >= 18
    PRINT 'Es adulto';
ELSE
    PRINT 'Es menor de edad';

‚úÖ Sirve para controlar el flujo de ejecuci√≥n.


---

üîπ Cursores (Cursors)

Un cursor permite recorrer fila por fila un conjunto de resultados.

DECLARE @Nombre NVARCHAR(50);

DECLARE empleado_cursor CURSOR FOR
SELECT Nombre FROM Empleados;

OPEN empleado_cursor;
FETCH NEXT FROM empleado_cursor INTO @Nombre;

WHILE @@FETCH_STATUS = 0
BEGIN
    PRINT @Nombre;
    FETCH NEXT FROM empleado_cursor INTO @Nombre;
END;

CLOSE empleado_cursor;
DEALLOCATE empleado_cursor;

‚úÖ Se usa cuando es necesario procesar registros uno por uno.
‚ö†Ô∏è Son menos eficientes que trabajar con consultas en bloque.


---

üß† Conclusi√≥n

Herramienta	Para qu√© se usa	Devuelve valor

Funci√≥n	C√°lculos y transformaciones	‚úÖ S√≠
Procedimiento	Automatizar tareas o modificar datos	‚ùå No
Variable	Guardar valores durante el script	‚Äî
IF	Tomar decisiones l√≥gicas	‚Äî
Cursor	Recorrer registros uno por uno	‚Äî (pero imprime o procesa)


